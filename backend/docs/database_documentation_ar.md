# ุชูุซูู ูุงุนุฏุฉ ุจูุงูุงุช ุตูุงุน

> ุชูุซูู ุดุงูู ููููู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุณุชุฎุฑุฌ ูู ูููุงุช ุงูุชุฑุญูู (Migrations).

---

## ุฌุฏูู ุงููุญุชููุงุช
1. [ูุธุฑุฉ ุนุงูุฉ](#ูุธุฑุฉ-ุนุงูุฉ)
2. [ุงูุฌุฏุงูู ูุฎุตุงุฆุตูุง](#ุงูุฌุฏุงูู-ูุฎุตุงุฆุตูุง)
3. [ูุฎุทุท ุงูุนูุงูุงุช (ERD)](#ูุฎุทุท-ุงูุนูุงูุงุช-erd)
4. [ูุฎุทุท ุชุฏูู ุงูุจูุงูุงุช (DFD)](#ูุฎุทุท-ุชุฏูู-ุงูุจูุงูุงุช-dfd)
5. [ููุฎุต ุงูุนูุงูุงุช](#ููุฎุต-ุงูุนูุงูุงุช)
6. [ูุฑุฌุน ุงููููุฏ](#ูุฑุฌุน-ุงููููุฏ)
7. [ูุฑุฌุน ุงูููุงุฑุณ](#ูุฑุฌุน-ุงูููุงุฑุณ)

---

## ูุธุฑุฉ ุนุงูุฉ

ุชุชููู ูุงุนุฏุฉ ุจูุงูุงุช ุตูุงุน ูู **17 ุฌุฏูู** ููุธูุฉ ูู ุงููุฌุงูุงุช ุงููุธูููุฉ ุงูุชุงููุฉ:

| ุงููุฌุงู | ุงูุฌุฏุงูู |
|--------|---------|
| **ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู** | `users` |
| **ุฅุฏุงุฑุฉ ุงููุดุงุฑูุน/ุงููุชุงุฌุฑ** | `projects`ุ `user_favorites` |
| **ูุชุงููุฌ ุงูููุชุฌุงุช** | `categories`ุ `products`ุ `product_images`ุ `product_variants`ุ `tags`ุ `product_tags` |
| **ุงูุชุณูู** | `cart_items` |
| **ุงูุชูุงุตู** | `conversations`ุ `messages` |
| **ุงููุนุงููุงุช** | `transactions`ุ `reviews` |
| **ุงูุฏุนู** | `support_tickets`ุ `notifications` |
| **ุงููุธุงู** | `system_settings` |

---

## ุงูุฌุฏุงูู ูุฎุตุงุฆุตูุง

### 1. ุฌุฏูู `users` (ุงููุณุชุฎุฏููู)
ุฌุฏูู ุงููุณุชุฎุฏููู ุงููุฑูุฒู ูุชุฎุฒูู ุฌููุน ุญุณุงุจุงุช ุงููุณุชุฎุฏููู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงููุณุชุฎุฏู ุงููุฑูุฏ |
| `email` | ูุต (255) | **ูุฑูุฏ**ุ ุฅูุฒุงูู | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู |
| `password_hash` | ูุต (255) | ุฅูุฒุงูู | ูููุฉ ุงููุฑูุฑ ุงููุดูุฑุฉ |
| `phone` | ูุต (20) | ุงุฎุชูุงุฑู | ุฑูู ุงููุงุชู |
| `full_name` | ูุต (100) | ุฅูุฒุงูู | ุงูุงุณู ุงููุงูู |
| `avatar_url` | ูุต (500) | ุงุฎุชูุงุฑู | ุฑุงุจุท ุตูุฑุฉ ุงูููู ุงูุดุฎุตู |
| `role` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'customer' | `customer`ุ `project_owner`ุ `admin` |
| `language` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'ar' | `ar`ุ `en` |
| `is_active` | ููุทูู | ุงูุชุฑุงุถู true | ุญุงูุฉ ุชูุนูู ุงูุญุณุงุจ |
| `is_banned` | ููุทูู | ุงูุชุฑุงุถู false | ุญุงูุฉ ุงูุญุธุฑ |
| `ban_reason` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุณุจุจ ุงูุญุธุฑ |
| `refresh_token` | ูุต (500) | ุงุฎุชูุงุฑู | ุฑูุฒ ุงูุชุญุฏูุซ JWT |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |
| `updated_at` | ุชุงุฑูุฎ ูููุช | ุชุญุฏูุซ ุชููุงุฆู | ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ |

**ุงูููุงุฑุณ:** `email`ุ `role`ุ `is_active`

---

### 2. ุฌุฏูู `projects` (ุงููุดุงุฑูุน)
ูุฎุฒู ูุนูููุงุช ุงููุดุงุฑูุน/ุงููุชุงุฌุฑ ูุฃุตุญุงุจ ุงููุดุงุฑูุน.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงููุดุฑูุน ุงููุฑูุฏ |
| `owner_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ **ูุฑูุฏ**ุ ุฅูุฒุงูู | ูุฑุฌุน ุตุงุญุจ ุงููุดุฑูุน |
| `name` | ูุต (100) | ุฅูุฒุงูู | ุงุณู ุงููุดุฑูุน (ุฅูุฌููุฒู) |
| `name_ar` | ูุต (100) | ุฅูุฒุงูู | ุงุณู ุงููุดุฑูุน (ุนุฑุจู) |
| `description` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุงููุตู (ุฅูุฌููุฒู) |
| `description_ar` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุงููุตู (ุนุฑุจู) |
| `logo_url` | ูุต (500) | ุงุฎุชูุงุฑู | ุฑุงุจุท ุงูุดุนุงุฑ |
| `cover_url` | ูุต (500) | ุงุฎุชูุงุฑู | ุฑุงุจุท ุตูุฑุฉ ุงูุบูุงู |
| `city` | ูุต (100) | ุฅูุฒุงูู | ุงููุฏููุฉ |
| `latitude` | ุนุดุฑู (10,8) | ุงุฎุชูุงุฑู | ุฎุท ุงูุนุฑุถ GPS |
| `longitude` | ุนุดุฑู (11,8) | ุงุฎุชูุงุฑู | ุฎุท ุงูุทูู GPS |
| `working_hours` | JSON | ุงุฎุชูุงุฑู | ุฌุฏูู ุณุงุนุงุช ุงูุนูู |
| `social_links` | JSON | ุงุฎุชูุงุฑู | ุฑูุงุจุท ุงูุชูุงุตู ุงูุงุฌุชูุงุนู |
| `status` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'pending' | `pending`ุ `approved`ุ `rejected`ุ `disabled` |
| `rejection_reason` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุณุจุจ ุงูุฑูุถ |
| `disable_reason` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุณุจุจ ุงูุชุนุทูู |
| `average_rating` | ุนุดุฑู (2,1) | ุงูุชุฑุงุถู 0 | ูุชูุณุท ุงูุชูููู |
| `total_reviews` | ุนุฏุฏ ุตุญูุญ | ุงูุชุฑุงุถู 0 | ุนุฏุฏ ุงููุฑุงุฌุนุงุช |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |
| `updated_at` | ุชุงุฑูุฎ ูููุช | ุชุญุฏูุซ ุชููุงุฆู | ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ |

**ุงูููุงุฑุณ:** `owner_id`ุ `status`ุ `city`ุ `average_rating`

**ุฅุฌุฑุงุกุงุช ุงูููุชุงุญ ุงูุฎุงุฑุฌู:** ุญุฐู ุชุณูุณููุ ุชุญุฏูุซ ุชุณูุณูู

---

### 3. ุฌุฏูู `categories` (ุงููุฆุงุช)
ูุฆุงุช ุงูููุชุฌุงุช ูุน ุฏุนู ุงูุชุณูุณู ุงููุฑูู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงููุฆุฉ ุงููุฑูุฏ |
| `parent_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโcategories.id**ุ ุงุฎุชูุงุฑู | ุงููุฆุฉ ุงูุฃุจ (ูุฑุฌุน ุฐุงุชู) |
| `name` | ูุต (100) | ุฅูุฒุงูู | ุงุณู ุงููุฆุฉ (ุฅูุฌููุฒู) |
| `name_ar` | ูุต (100) | ุฅูุฒุงูู | ุงุณู ุงููุฆุฉ (ุนุฑุจู) |
| `icon` | ูุต (100) | ุงุฎุชูุงุฑู | ูุนุฑู ุงูุฃููููุฉ |
| `sort_order` | ุนุฏุฏ ุตุญูุญ | ุงูุชุฑุงุถู 0 | ุชุฑุชูุจ ุงูุนุฑุถ |
| `is_active` | ููุทูู | ุงูุชุฑุงุถู true | ุญุงูุฉ ุงููุดุงุท |
| `status` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'active' | `active`ุ `inactive`ุ `pending`ุ `rejected` |
| `created_by` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุงุฎุชูุงุฑู | ุงููุณุชุฎุฏู ุงูุฐู ุฃูุดุฃ ุงููุฆุฉ |
| `rejection_reason` | ูุต (255) | ุงุฎุชูุงุฑู | ุณุจุจ ุงูุฑูุถ |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

**ุงูููุงุฑุณ:** `parent_id`ุ `is_active`ุ `sort_order`ุ `status`

---

### 4. ุฌุฏูู `products` (ุงูููุชุฌุงุช)
ุงูุฌุฏูู ุงูุฑุฆูุณู ููุชุงููุฌ ุงูููุชุฌุงุช.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงูููุชุฌ ุงููุฑูุฏ |
| `project_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโprojects.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงููุดุฑูุน |
| `category_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโcategories.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงููุฆุฉ |
| `name` | ูุต (200) | ุฅูุฒุงูู | ุงุณู ุงูููุชุฌ (ุฅูุฌููุฒู) |
| `name_ar` | ูุต (200) | ุฅูุฒุงูู | ุงุณู ุงูููุชุฌ (ุนุฑุจู) |
| `description` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุงููุตู (ุฅูุฌููุฒู) |
| `description_ar` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุงููุตู (ุนุฑุจู) |
| `base_price` | ุนุดุฑู (10,2) | ุฅูุฒุงูู | ุงูุณุนุฑ ุงูุฃุณุงุณู |
| `poster_image_url` | ูุต (500) | ุฅูุฒุงูู | ุตูุฑุฉ ุงูููุชุฌ ุงูุฑุฆูุณูุฉ |
| `quantity` | ุนุฏุฏ ุตุญูุญ | ุงูุชุฑุงุถู 0 | ูููุฉ ุงููุฎุฒูู |
| `is_available` | ููุทูู | ุงูุชุฑุงุถู true | ุญุงูุฉ ุงูุชููุฑ |
| `status` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'pending' | `pending`ุ `approved`ุ `rejected` |
| `rejection_reason` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุณุจุจ ุงูุฑูุถ |
| `average_rating` | ุนุดุฑู (2,1) | ุงูุชุฑุงุถู 0 | ูุชูุณุท ุงูุชูููู |
| `total_reviews` | ุนุฏุฏ ุตุญูุญ | ุงูุชุฑุงุถู 0 | ุนุฏุฏ ุงููุฑุงุฌุนุงุช |
| `view_count` | ุนุฏุฏ ุตุญูุญ | ุงูุชุฑุงุถู 0 | ุนุฏุงุฏ ุงููุดุงูุฏุงุช |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |
| `updated_at` | ุชุงุฑูุฎ ูููุช | ุชุญุฏูุซ ุชููุงุฆู | ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ |

**ุงูููุงุฑุณ:** `project_id`ุ `category_id`ุ `status`ุ `is_available`ุ `average_rating`ุ `created_at`

---

### 5. ุฌุฏูู `product_images` (ุตูุฑ ุงูููุชุฌุงุช)
ุตูุฑ ุฅุถุงููุฉ ููููุชุฌุงุช.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงูุตูุฑุฉ ุงููุฑูุฏ |
| `product_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโproducts.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงูููุชุฌ |
| `image_url` | ูุต (500) | ุฅูุฒุงูู | ุฑุงุจุท ุงูุตูุฑุฉ |
| `sort_order` | ุนุฏุฏ ุตุญูุญ | ุงูุชุฑุงุถู 0 | ุชุฑุชูุจ ุงูุนุฑุถ |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

---

### 6. ุฌุฏูู `product_variants` (ูุชุบูุฑุงุช ุงูููุชุฌุงุช)
ูุชุบูุฑุงุช ุงูููุชุฌ (ุฃุญุฌุงูุ ุฃููุงูุ ุฅูุฎ).

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงููุชุบูุฑ ุงููุฑูุฏ |
| `product_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโproducts.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงูููุชุฌ |
| `name` | ูุต (100) | ุฅูุฒุงูู | ุงุณู ุงููุชุบูุฑ (ุฅูุฌููุฒู) |
| `name_ar` | ูุต (100) | ุฅูุฒุงูู | ุงุณู ุงููุชุบูุฑ (ุนุฑุจู) |
| `price_modifier` | ุนุดุฑู (10,2) | ุงูุชุฑุงุถู 0 | ุชุนุฏูู ุงูุณุนุฑ |
| `quantity` | ุนุฏุฏ ุตุญูุญ | ุงูุชุฑุงุถู 0 | ูููุฉ ุงููุฎุฒูู |
| `is_available` | ููุทูู | ุงูุชุฑุงุถู true | ุญุงูุฉ ุงูุชููุฑ |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

---

### 7. ุฌุฏูู `tags` (ุงููุณูู)
ูุณูู ุงูููุชุฌุงุช ููุชุตููู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงููุณู ุงููุฑูุฏ |
| `name` | ูุต (50) | ุฅูุฒุงูู | ุงุณู ุงููุณู (ุฅูุฌููุฒู) |
| `name_ar` | ูุต (50) | ุฅูุฒุงูู | ุงุณู ุงููุณู (ุนุฑุจู) |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

---

### 8. ุฌุฏูู `product_tags` (ุฌุฏูู ูุณูุท)
ุนูุงูุฉ ูุชุนุฏุฏ-ูู-ูุชุนุฏุฏ ุจูู ุงูููุชุฌุงุช ูุงููุณูู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `product_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ **ููุชุงุญ ุฎุงุฑุฌูโproducts.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงูููุชุฌ |
| `tag_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ **ููุชุงุญ ุฎุงุฑุฌูโtags.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงููุณู |

**ููุชุงุญ ุฃุณุงุณู ูุฑูุจ:** (`product_id`ุ `tag_id`)

---

### 9. ุฌุฏูู `cart_items` (ุนูุงุตุฑ ุงูุณูุฉ)
ุนูุงุตุฑ ุณูุฉ ุงูุชุณูู ูููุณุชุฎุฏู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงูุนูุตุฑ ุงููุฑูุฏ |
| `user_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงููุณุชุฎุฏู |
| `product_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโproducts.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงูููุชุฌ |
| `variant_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโproduct_variants.id**ุ ุงุฎุชูุงุฑู | ูุฑุฌุน ุงููุชุบูุฑ |
| `quantity` | ุนุฏุฏ ุตุญูุญ | ุงูุชุฑุงุถู 1 | ุงููููุฉ |
| `note` | ูุต ุทููู | ุงุฎุชูุงุฑู | ููุงุญุธุฉ ุงุฎุชูุงุฑูุฉ |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

**ููุฏ ูุฑูุฏ:** `unique_cart_item` ุนูู (`user_id`ุ `product_id`ุ `variant_id`)

---

### 10. ุฌุฏูู `conversations` (ุงููุญุงุฏุซุงุช)
ูุญุงุฏุซุงุช ุงูุฏุฑุฏุดุฉ ุจูู ุงููุณุชุฎุฏููู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงููุญุงุฏุซุฉ ุงููุฑูุฏ |
| `user1_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ุงููุณุชุฎุฏู ุงูุฃูู (ID ุงูุฃุตุบุฑ) |
| `user2_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ุงููุณุชุฎุฏู ุงูุซุงูู (ID ุงูุฃูุจุฑ) |
| `project_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโprojects.id**ุ ุงุฎุชูุงุฑู | ุณูุงู ุงููุดุฑูุน ุงููุฑุชุจุท |
| `last_message_at` | ุชุงุฑูุฎ ูููุช | ุงุฎุชูุงุฑู | ุชุงุฑูุฎ ุขุฎุฑ ุฑุณุงูุฉ |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

**ููุฏ ูุฑูุฏ:** `unique_user_pair` ุนูู (`user1_id`ุ `user2_id`)

---

### 11. ุฌุฏูู `messages` (ุงูุฑุณุงุฆู)
ุฑุณุงุฆู ุงูุฏุฑุฏุดุฉ ุฏุงุฎู ุงููุญุงุฏุซุงุช.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงูุฑุณุงูุฉ ุงููุฑูุฏ |
| `conversation_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโconversations.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงููุญุงุฏุซุฉ |
| `sender_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงููุฑุณู |
| `content` | ูุต ุทููู | ุฅูุฒุงูู | ูุญุชูู ุงูุฑุณุงูุฉ |
| `message_type` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'text' | `text`ุ `inquiry`ุ `image`ุ `transaction` |
| `is_read` | ููุทูู | ุงูุชุฑุงุถู false | ุญุงูุฉ ุงููุฑุงุกุฉ |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

---

### 12. ุฌุฏูู `transactions` (ุงููุนุงููุงุช)
ูุนุงููุงุช ุงูุดุฑุงุก ุจูู ุงููุณุชุฎุฏููู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงููุนุงููุฉ ุงููุฑูุฏ |
| `conversation_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโconversations.id**ุ ุฅูุฒุงูู | ุงููุญุงุฏุซุฉ ุงููุฑุชุจุทุฉ |
| `product_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโproducts.id**ุ ุงุฎุชูุงุฑู | ุงูููุชุฌ ุงููุฑุชุจุท |
| `initiated_by` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ุงููุณุชุฎุฏู ุงูุฐู ุจุฏุฃ ุงููุนุงููุฉ |
| `customer_confirmed` | ููุทูู | ุงูุชุฑุงุถู false | ุชุฃููุฏ ุงูุนููู |
| `seller_confirmed` | ููุทูู | ุงูุชุฑุงุถู false | ุชุฃููุฏ ุงูุจุงุฆุน |
| `customer_confirmed_at` | ุชุงุฑูุฎ ูููุช | ุงุฎุชูุงุฑู | ููุช ุชุฃููุฏ ุงูุนููู |
| `seller_confirmed_at` | ุชุงุฑูุฎ ูููุช | ุงุฎุชูุงุฑู | ููุช ุชุฃููุฏ ุงูุจุงุฆุน |
| `status` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'pending' | `pending`ุ `confirmed`ุ `disputed`ุ `cancelled` |
| `auto_confirm_at` | ุชุงุฑูุฎ ูููุช | ุฅูุฒุงูู | ููุนุฏ ุงูุชุฃููุฏ ุงูุชููุงุฆู |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

---

### 13. ุฌุฏูู `reviews` (ุงููุฑุงุฌุนุงุช)
ูุฑุงุฌุนุงุช ุงูููุชุฌุงุช ูู ุงูุนููุงุก.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงููุฑุงุฌุนุฉ ุงููุฑูุฏ |
| `product_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโproducts.id**ุ ุฅูุฒุงูู | ุงูููุชุฌ ุงูููุฑุงุฌูุน |
| `user_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ุงูููุฑุงุฌูุน |
| `transaction_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโtransactions.id**ุ ุฅูุฒุงูู | ุงููุนุงููุฉ ุงููุฑุชุจุทุฉ |
| `rating` | ุนุฏุฏ ุตุบูุฑ | ุฅูุฒุงููุ ูุทุงู (1-5) | ุฏุฑุฌุฉ ุงูุชูููู |
| `comment` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุชุนููู ุงููุฑุงุฌุนุฉ |
| `status` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'pending' | `pending`ุ `approved`ุ `rejected` |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

**ููุฏ ูุฑูุฏ:** `unique_review` ุนูู (`product_id`ุ `user_id`ุ `transaction_id`)

---

### 14. ุฌุฏูู `support_tickets` (ุชุฐุงูุฑ ุงูุฏุนู)
ุชุฐุงูุฑ ุฏุนู ุงูุนููุงุก.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงูุชุฐูุฑุฉ ุงููุฑูุฏ |
| `user_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ููุดุฆ ุงูุชุฐูุฑุฉ |
| `type` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุฅูุฒุงูู | `general`ุ `dispute`ุ `report`ุ `feedback` |
| `subject` | ูุต (200) | ุฅูุฒุงูู | ููุถูุน ุงูุชุฐูุฑุฉ |
| `description` | ูุต ุทููู | ุฅูุฒุงูู | ูุตู ุงูุชุฐูุฑุฉ |
| `related_id` | ุนุฏุฏ ุตุญูุญ | ุงุฎุชูุงุฑู | ูุนุฑู ุงูููุงู ุงููุฑุชุจุท |
| `related_type` | ูุต (50) | ุงุฎุชูุงุฑู | ููุน ุงููุฑุฌุน |
| `status` | ูุงุฆูุฉ ุงุฎุชูุงุฑ | ุงูุชุฑุงุถู 'open' | `open`ุ `in_progress`ุ `resolved`ุ `closed` |
| `assigned_to` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุงุฎุชูุงุฑู | ุงููุณุคูู ุงููุนูู |
| `resolution` | ูุต ุทููู | ุงุฎุชูุงุฑู | ููุงุญุธุงุช ุงูุญู |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |
| `updated_at` | ุชุงุฑูุฎ ูููุช | ุชุญุฏูุซ ุชููุงุฆู | ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ |

---

### 15. ุฌุฏูู `notifications` (ุงูุฅุดุนุงุฑุงุช)
ุฅุดุนุงุฑุงุช ุงููุณุชุฎุฏู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงูุฅุดุนุงุฑ ุงููุฑูุฏ |
| `user_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ุงููุณุชุฎุฏู ุงููุณุชูุฏู |
| `type` | ูุต (50) | ุฅูุฒุงูู | ููุน ุงูุฅุดุนุงุฑ |
| `title` | ูุต (200) | ุฅูุฒุงูู | ุงูุนููุงู (ุฅูุฌููุฒู) |
| `title_ar` | ูุต (200) | ุฅูุฒุงูู | ุงูุนููุงู (ุนุฑุจู) |
| `body` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุงููุญุชูู (ุฅูุฌููุฒู) |
| `body_ar` | ูุต ุทููู | ุงุฎุชูุงุฑู | ุงููุญุชูู (ุนุฑุจู) |
| `data` | JSON | ุงุฎุชูุงุฑู | ุจูุงูุงุช ุฅุถุงููุฉ |
| `is_read` | ููุทูู | ุงูุชุฑุงุถู false | ุญุงูุฉ ุงููุฑุงุกุฉ |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

---

### 16. ุฌุฏูู `system_settings` (ุฅุนุฏุงุฏุงุช ุงููุธุงู)
ุฅุนุฏุงุฏุงุช ุชูููู ุงูุชุทุจูู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงูุฅุนุฏุงุฏ ุงููุฑูุฏ |
| `setting_key` | ูุต (100) | **ูุฑูุฏ**ุ ุฅูุฒุงูู | ููุชุงุญ ุงูุฅุนุฏุงุฏ |
| `setting_value` | ูุต ุทููู | ุฅูุฒุงูู | ูููุฉ ุงูุฅุนุฏุงุฏ |
| `description` | ูุต (255) | ุงุฎุชูุงุฑู | ูุตู ุงูุฅุนุฏุงุฏ |
| `updated_at` | ุชุงุฑูุฎ ูููุช | ุชุญุฏูุซ ุชููุงุฆู | ุชุงุฑูุฎ ุขุฎุฑ ุชุญุฏูุซ |

---

### 17. ุฌุฏูู `user_favorites` (ููุถูุงุช ุงููุณุชุฎุฏู)
ุงููุดุงุฑูุน ุงูููุถูุฉ ูููุณุชุฎุฏู.

| ุงูุนููุฏ | ุงูููุน | ุงููููุฏ | ุงููุตู |
|--------|------|--------|-------|
| `id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฃุณุงุณู**ุ ุชุฒุงูุฏ ุชููุงุฆู | ูุนุฑู ุงูููุถูุฉ ุงููุฑูุฏ |
| `user_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโusers.id**ุ ุฅูุฒุงูู | ูุฑุฌุน ุงููุณุชุฎุฏู |
| `project_id` | ุนุฏุฏ ุตุญูุญ | **ููุชุงุญ ุฎุงุฑุฌูโprojects.id**ุ ุฅูุฒุงูู | ุงููุดุฑูุน ุงูููุถู |
| `created_at` | ุชุงุฑูุฎ ูููุช | ุงูุชุฑุงุถู ุงูููุช ุงูุญุงูู | ุชุงุฑูุฎ ุงูุฅูุดุงุก |

**ููุฏ ูุฑูุฏ:** `user_favorites_user_project_unique` ุนูู (`user_id`ุ `project_id`)

---

## ูุฎุทุท ุงูุนูุงูุงุช (ERD)

```mermaid
erDiagram
    users ||--o| projects : "ูููู (1:1)"
    users ||--o{ cart_items : "ูุฏูู"
    users ||--o{ conversations : "ูุดุงุฑู (ููุณุชุฎุฏู1)"
    users ||--o{ conversations : "ูุดุงุฑู (ููุณุชุฎุฏู2)"
    users ||--o{ messages : "ูุฑุณู"
    users ||--o{ transactions : "ูุจุฏุฃ"
    users ||--o{ reviews : "ููุชุจ"
    users ||--o{ support_tickets : "ููุดุฆ"
    users ||--o{ support_tickets : "ูุนูู_ูู"
    users ||--o{ notifications : "ูุณุชูู"
    users ||--o{ user_favorites : "ูุฏูู"
    users ||--o{ categories : "ููุดุฆ"
    
    projects ||--o{ products : "ูุญุชูู"
    projects ||--o{ conversations : "ุณูุงู"
    projects ||--o{ user_favorites : "ููุถู_ุจูุงุณุทุฉ"
    
    categories ||--o| categories : "ุฃุจ_ูู"
    categories ||--o{ products : "ูุตูู"
    
    products ||--o{ product_images : "ูุฏูู"
    products ||--o{ product_variants : "ูุฏูู"
    products ||--o{ product_tags : "ููุณูู_ุจู"
    products ||--o{ cart_items : "ูู"
    products ||--o{ transactions : "ูุฑุชุจุท_ุจู"
    products ||--o{ reviews : "ููุฑุงุฌูุน_ูู"
    
    tags ||--o{ product_tags : "ูุทุจู_ุนูู"
    
    product_variants ||--o{ cart_items : "ูุฎุชุงุฑ_ูู"
    
    conversations ||--o{ messages : "ูุญุชูู"
    conversations ||--o{ transactions : "ูุฑุชุจุท_ุจู"
    
    transactions ||--o{ reviews : "ููููู"

    users {
        int id ููุชุงุญ_ุฃุณุงุณู
        string email ูุฑูุฏ
        string password_hash
        string phone
        string full_name
        string avatar_url
        enum role
        enum language
        boolean is_active
        boolean is_banned
        text ban_reason
        string refresh_token
        timestamp created_at
        timestamp updated_at
    }
    
    projects {
        int id ููุชุงุญ_ุฃุณุงุณู
        int owner_id ููุชุงุญ_ุฎุงุฑุฌู_ูุฑูุฏ
        string name
        string name_ar
        text description
        text description_ar
        string logo_url
        string cover_url
        string city
        decimal latitude
        decimal longitude
        json working_hours
        json social_links
        enum status
        text rejection_reason
        text disable_reason
        decimal average_rating
        int total_reviews
        timestamp created_at
        timestamp updated_at
    }
    
    categories {
        int id ููุชุงุญ_ุฃุณุงุณู
        int parent_id ููุชุงุญ_ุฎุงุฑุฌู
        string name
        string name_ar
        string icon
        int sort_order
        boolean is_active
        enum status
        int created_by ููุชุงุญ_ุฎุงุฑุฌู
        string rejection_reason
        timestamp created_at
    }
    
    products {
        int id ููุชุงุญ_ุฃุณุงุณู
        int project_id ููุชุงุญ_ุฎุงุฑุฌู
        int category_id ููุชุงุญ_ุฎุงุฑุฌู
        string name
        string name_ar
        text description
        text description_ar
        decimal base_price
        string poster_image_url
        int quantity
        boolean is_available
        enum status
        text rejection_reason
        decimal average_rating
        int total_reviews
        int view_count
        timestamp created_at
        timestamp updated_at
    }
    
    product_images {
        int id ููุชุงุญ_ุฃุณุงุณู
        int product_id ููุชุงุญ_ุฎุงุฑุฌู
        string image_url
        int sort_order
        timestamp created_at
    }
    
    product_variants {
        int id ููุชุงุญ_ุฃุณุงุณู
        int product_id ููุชุงุญ_ุฎุงุฑุฌู
        string name
        string name_ar
        decimal price_modifier
        int quantity
        boolean is_available
        timestamp created_at
    }
    
    tags {
        int id ููุชุงุญ_ุฃุณุงุณู
        string name
        string name_ar
        timestamp created_at
    }
    
    product_tags {
        int product_id ููุชุงุญ_ุฃุณุงุณู_ุฎุงุฑุฌู
        int tag_id ููุชุงุญ_ุฃุณุงุณู_ุฎุงุฑุฌู
    }
    
    cart_items {
        int id ููุชุงุญ_ุฃุณุงุณู
        int user_id ููุชุงุญ_ุฎุงุฑุฌู
        int product_id ููุชุงุญ_ุฎุงุฑุฌู
        int variant_id ููุชุงุญ_ุฎุงุฑุฌู
        int quantity
        text note
        timestamp created_at
    }
    
    conversations {
        int id ููุชุงุญ_ุฃุณุงุณู
        int user1_id ููุชุงุญ_ุฎุงุฑุฌู
        int user2_id ููุชุงุญ_ุฎุงุฑุฌู
        int project_id ููุชุงุญ_ุฎุงุฑุฌู
        timestamp last_message_at
        timestamp created_at
    }
    
    messages {
        int id ููุชุงุญ_ุฃุณุงุณู
        int conversation_id ููุชุงุญ_ุฎุงุฑุฌู
        int sender_id ููุชุงุญ_ุฎุงุฑุฌู
        text content
        enum message_type
        boolean is_read
        timestamp created_at
    }
    
    transactions {
        int id ููุชุงุญ_ุฃุณุงุณู
        int conversation_id ููุชุงุญ_ุฎุงุฑุฌู
        int product_id ููุชุงุญ_ุฎุงุฑุฌู
        int initiated_by ููุชุงุญ_ุฎุงุฑุฌู
        boolean customer_confirmed
        boolean seller_confirmed
        timestamp customer_confirmed_at
        timestamp seller_confirmed_at
        enum status
        timestamp auto_confirm_at
        timestamp created_at
    }
    
    reviews {
        int id ููุชุงุญ_ุฃุณุงุณู
        int product_id ููุชุงุญ_ุฎุงุฑุฌู
        int user_id ููุชุงุญ_ุฎุงุฑุฌู
        int transaction_id ููุชุงุญ_ุฎุงุฑุฌู
        tinyint rating
        text comment
        enum status
        timestamp created_at
    }
    
    support_tickets {
        int id ููุชุงุญ_ุฃุณุงุณู
        int user_id ููุชุงุญ_ุฎุงุฑุฌู
        enum type
        string subject
        text description
        int related_id
        string related_type
        enum status
        int assigned_to ููุชุงุญ_ุฎุงุฑุฌู
        text resolution
        timestamp created_at
        timestamp updated_at
    }
    
    notifications {
        int id ููุชุงุญ_ุฃุณุงุณู
        int user_id ููุชุงุญ_ุฎุงุฑุฌู
        string type
        string title
        string title_ar
        text body
        text body_ar
        json data
        boolean is_read
        timestamp created_at
    }
    
    system_settings {
        int id ููุชุงุญ_ุฃุณุงุณู
        string setting_key ูุฑูุฏ
        text setting_value
        string description
        timestamp updated_at
    }
    
    user_favorites {
        int id ููุชุงุญ_ุฃุณุงุณู
        int user_id ููุชุงุญ_ุฎุงุฑุฌู
        int project_id ููุชุงุญ_ุฎุงุฑุฌู
        timestamp created_at
    }
```

---

## ูุฎุทุท ุชุฏูู ุงูุจูุงูุงุช (DFD)

```mermaid
flowchart TB
    subgraph External["ุงูููุงูุงุช ุงูุฎุงุฑุฌูุฉ"]
        CUSTOMER["๐ค ุงูุนููู"]
        PROJECT_OWNER["๐ช ุตุงุญุจ ุงููุดุฑูุน"]
        ADMIN["๐จโ๐ผ ุงููุณุคูู"]
    end
    
    subgraph Processes["ุงูุนูููุงุช ุงูุฃุณุงุณูุฉ"]
        P1["1.0 ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู"]
        P2["2.0 ุฅุฏุงุฑุฉ ุงููุดุงุฑูุน"]
        P3["3.0 ุฅุฏุงุฑุฉ ุงูููุชุฌุงุช"]
        P4["4.0 ุณูุฉ ุงูุชุณูู"]
        P5["5.0 ูุธุงู ุงููุฑุงุณูุฉ"]
        P6["6.0 ูุนุงูุฌุฉ ุงููุนุงููุงุช"]
        P7["7.0 ูุธุงู ุงููุฑุงุฌุนุงุช"]
        P8["8.0 ูุธุงู ุงูุฏุนู"]
        P9["9.0 ูุธุงู ุงูุฅุดุนุงุฑุงุช"]
    end
    
    subgraph DataStores["ูุฎุงุฒู ุงูุจูุงูุงุช"]
        D1[("users ุงููุณุชุฎุฏููู")]
        D2[("projects ุงููุดุงุฑูุน")]
        D3[("categories ุงููุฆุงุช")]
        D4[("products ุงูููุชุฌุงุช")]
        D5[("product_images ุงูุตูุฑ")]
        D6[("product_variants ุงููุชุบูุฑุงุช")]
        D7[("tags/product_tags ุงููุณูู")]
        D8[("cart_items ุงูุณูุฉ")]
        D9[("conversations ุงููุญุงุฏุซุงุช")]
        D10[("messages ุงูุฑุณุงุฆู")]
        D11[("transactions ุงููุนุงููุงุช")]
        D12[("reviews ุงููุฑุงุฌุนุงุช")]
        D13[("support_tickets ุงูุชุฐุงูุฑ")]
        D14[("notifications ุงูุฅุดุนุงุฑุงุช")]
        D15[("system_settings ุงูุฅุนุฏุงุฏุงุช")]
        D16[("user_favorites ุงูููุถูุงุช")]
    end
    
    %% ุชุฏููุงุช ุงููุณุชุฎุฏู
    CUSTOMER -->|"ุชุณุฌูู/ุฏุฎูู"| P1
    PROJECT_OWNER -->|"ุชุณุฌูู/ุฏุฎูู"| P1
    ADMIN -->|"ุฏุฎูู"| P1
    P1 <-->|"ุจูุงูุงุช ุงููุณุชุฎุฏู"| D1
    
    %% ุชุฏููุงุช ุงููุดุฑูุน
    PROJECT_OWNER -->|"ุฅูุดุงุก/ุชุนุฏูู ุงููุดุฑูุน"| P2
    ADMIN -->|"ููุงููุฉ/ุฑูุถ ุงููุดุฑูุน"| P2
    P2 <-->|"ุจูุงูุงุช ุงููุดุฑูุน"| D2
    
    %% ุชุฏููุงุช ุงูููุชุฌ
    PROJECT_OWNER -->|"ุฅุถุงูุฉ/ุชุนุฏูู ุงูููุชุฌุงุช"| P3
    ADMIN -->|"ููุงููุฉ/ุฑูุถ ุงูููุชุฌุงุช"| P3
    P3 <-->|"ุจูุงูุงุช ุงูููุชุฌ"| D4
    P3 <-->|"ุงูุตูุฑ"| D5
    P3 <-->|"ุงููุชุบูุฑุงุช"| D6
    P3 <-->|"ุงููุฆุงุช"| D3
    P3 <-->|"ุงููุณูู"| D7
    
    %% ุชุฏููุงุช ุงูุชุณูู
    CUSTOMER -->|"ุฅุถุงูุฉ ููุณูุฉ"| P4
    P4 <-->|"ุนูุงุตุฑ ุงูุณูุฉ"| D8
    P4 -.->|"ูุญุต ุงูููุชุฌุงุช"| D4
    P4 -.->|"ูุญุต ุงููุชุบูุฑุงุช"| D6
    
    %% ุชุฏููุงุช ุงููุฑุงุณูุฉ
    CUSTOMER -->|"ุฅุฑุณุงู ุฑุณุงูุฉ"| P5
    PROJECT_OWNER -->|"ุฑุฏ ุนูู ุงูุฑุณุงูุฉ"| P5
    P5 <-->|"ุงููุญุงุฏุซุงุช"| D9
    P5 <-->|"ุงูุฑุณุงุฆู"| D10
    
    %% ุชุฏููุงุช ุงููุนุงููุงุช
    CUSTOMER -->|"ุชุฃููุฏ ุงูุดุฑุงุก"| P6
    PROJECT_OWNER -->|"ุชุฃููุฏ ุงูุจูุน"| P6
    P6 <-->|"ุจูุงูุงุช ุงููุนุงููุฉ"| D11
    P6 -.->|"ุชุญุฏูุซ ุนุจุฑ"| D10
    
    %% ุชุฏููุงุช ุงููุฑุงุฌุนุงุช
    CUSTOMER -->|"ูุชุงุจุฉ ูุฑุงุฌุนุฉ"| P7
    ADMIN -->|"ุฅุฏุงุฑุฉ ุงููุฑุงุฌุนุฉ"| P7
    P7 <-->|"ุงููุฑุงุฌุนุงุช"| D12
    P7 -.->|"ูุชุทูุจ"| D11
    
    %% ุชุฏููุงุช ุงูุฏุนู
    CUSTOMER -->|"ุฅูุดุงุก ุชุฐูุฑุฉ"| P8
    PROJECT_OWNER -->|"ุฅูุดุงุก ุชุฐูุฑุฉ"| P8
    ADMIN -->|"ูุนุงูุฌุฉ ุงูุชุฐูุฑุฉ"| P8
    P8 <-->|"ุงูุชุฐุงูุฑ"| D13
    
    %% ุชุฏููุงุช ุงูุฅุดุนุงุฑุงุช
    P1 & P2 & P3 & P6 & P7 & P8 -->|"ุชุญููุฒ"| P9
    P9 <-->|"ุงูุฅุดุนุงุฑุงุช"| D14
    P9 -->|"ุฅุดุนุงุฑ ููุฑู"| CUSTOMER
    P9 -->|"ุฅุดุนุงุฑ ููุฑู"| PROJECT_OWNER
    
    %% ุงูููุถูุงุช
    CUSTOMER -->|"ุฅุถุงูุฉ ููููุถูุฉ"| D16
    
    %% ุฅุนุฏุงุฏุงุช ุงููุธุงู
    ADMIN -->|"ุชูููู"| D15
```

---

## ููุฎุต ุงูุนูุงูุงุช

### ุนูุงูุงุช ูุงุญุฏ-ูู-ูุงุญุฏ (1:1)
| ุงูุฌุฏูู ุงูุฃุจ | ุงูุฌุฏูู ุงูุชุงุจุน | ุนููุฏ ุงูููุชุงุญ ุงูุฎุงุฑุฌู | ุงููุตู |
|-------------|--------------|----------------------|-------|
| `users` | `projects` | `owner_id` | ูู ูุณุชุฎุฏู ููููู ุงูุชูุงู ูุดุฑูุน ูุงุญุฏ |

### ุนูุงูุงุช ูุงุญุฏ-ูู-ูุชุนุฏุฏ (1:N)
| ุงูุฌุฏูู ุงูุฃุจ | ุงูุฌุฏูู ุงูุชุงุจุน | ุนููุฏ ุงูููุชุงุญ ุงูุฎุงุฑุฌู | ุงููุตู |
|-------------|--------------|----------------------|-------|
| `users` | `cart_items` | `user_id` | ุนูุงุตุฑ ุณูุฉ ุงููุณุชุฎุฏู |
| `users` | `support_tickets` | `user_id` | ุชุฐุงูุฑ ุงููุณุชุฎุฏู |
| `users` | `notifications` | `user_id` | ุฅุดุนุงุฑุงุช ุงููุณุชุฎุฏู |
| `users` | `reviews` | `user_id` | ูุฑุงุฌุนุงุช ุงููุณุชุฎุฏู |
| `users` | `messages` | `sender_id` | ุฑุณุงุฆู ุงููุณุชุฎุฏู ุงููุฑุณูุฉ |
| `users` | `transactions` | `initiated_by` | ูุนุงููุงุช ุงููุณุชุฎุฏู |
| `users` | `user_favorites` | `user_id` | ููุถูุงุช ุงููุณุชุฎุฏู |
| `users` | `categories` | `created_by` | ูุฆุงุช ุฃูุดุฃูุง ุงููุณุชุฎุฏู |
| `projects` | `products` | `project_id` | ููุชุฌุงุช ุงููุดุฑูุน |
| `projects` | `conversations` | `project_id` | ูุญุงุฏุซุงุช ูุชุนููุฉ ุจุงููุดุฑูุน |
| `projects` | `user_favorites` | `project_id` | ุงููุณุชุฎุฏููู ุงูุฐูู ูุถููุง ุงููุดุฑูุน |
| `categories` | `categories` | `parent_id` | ุงูุชุณูุณู ุงููุฑูู ูููุฆุงุช (ูุฑุฌุน ุฐุงุชู) |
| `categories` | `products` | `category_id` | ููุชุฌุงุช ูู ุงููุฆุฉ |
| `products` | `product_images` | `product_id` | ุตูุฑ ุงูููุชุฌ |
| `products` | `product_variants` | `product_id` | ูุชุบูุฑุงุช ุงูููุชุฌ |
| `products` | `cart_items` | `product_id` | ุนูุงุตุฑ ุงูุณูุฉ ูุน ุงูููุชุฌ |
| `products` | `reviews` | `product_id` | ูุฑุงุฌุนุงุช ุงูููุชุฌ |
| `products` | `transactions` | `product_id` | ุงููุนุงููุงุช ุงููุฑุชุจุทุฉ |
| `product_variants` | `cart_items` | `variant_id` | ุนูุงุตุฑ ุงูุณูุฉ ูุน ุงููุชุบูุฑ |
| `conversations` | `messages` | `conversation_id` | ุงูุฑุณุงุฆู ูู ุงููุญุงุฏุซุฉ |
| `conversations` | `transactions` | `conversation_id` | ุงููุนุงููุงุช ูู ุงููุญุงุฏุซุฉ |
| `transactions` | `reviews` | `transaction_id` | ุงููุฑุงุฌุนุงุช ูููุนุงููุฉ |

### ุนูุงูุงุช ูุชุนุฏุฏ-ูู-ูุชุนุฏุฏ (N:M)
| ุงูุฌุฏูู 1 | ุงูุฌุฏูู 2 | ุงูุฌุฏูู ุงููุณูุท | ุงููุตู |
|---------|---------|--------------|-------|
| `products` | `tags` | `product_tags` | ูุณู ุงูููุชุฌุงุช |
| `users` | `users` | `conversations` | ูุญุงุฏุซุงุช ุงููุณุชุฎุฏููู |

---

## ูุฑุฌุน ุงููููุฏ

### ุงูููุงุชูุญ ุงูุฃุณุงุณูุฉ
ุฌููุน ุงูุฌุฏุงูู ุชุณุชุฎุฏู `id` (ุนุฏุฏ ุตุญูุญุ ุชุฒุงูุฏ ุชููุงุฆู) ูููุชุงุญ ุฃุณุงุณูุ ุจุงุณุชุซูุงุก:
- `product_tags`: ููุชุงุญ ุฃุณุงุณู ูุฑูุจ (`product_id`ุ `tag_id`)

### ุงููููุฏ ุงููุฑูุฏุฉ
| ุงูุฌุฏูู | ุงูุฃุนูุฏุฉ | ุงุณู ุงูููุฏ |
|--------|---------|-----------|
| `users` | `email` | (ุถููู) |
| `projects` | `owner_id` | (ุถููู) |
| `system_settings` | `setting_key` | (ุถููู) |
| `cart_items` | `user_id`ุ `product_id`ุ `variant_id` | `unique_cart_item` |
| `conversations` | `user1_id`ุ `user2_id` | `unique_user_pair` |
| `reviews` | `product_id`ุ `user_id`ุ `transaction_id` | `unique_review` |
| `user_favorites` | `user_id`ุ `project_id` | `user_favorites_user_project_unique` |

### ููุฎุต ุฅุฌุฑุงุกุงุช ุงูููุงุชูุญ ุงูุฎุงุฑุฌูุฉ

| ุงูุฅุฌุฑุงุก | ุงูุงุณุชุฎุฏุงู |
|---------|----------|
| `CASCADE` | ุงูุฃูุซุฑ ุดููุนุงู - ุงูุญุฐู/ุงูุชุญุฏูุซ ููุชุดุฑ |
| `SET NULL` | ุนูุงูุงุช ุฃุจ-ุงุจู ุญูุซ ูููู ููุงุจู ุงููุฌูุฏ ุจุฏูู ุงูุฃุจ |
| `RESTRICT` | ุนูุงูุงุช ุญุฑุฌุฉ ูุฌุจ ุงูุญูุงุธ ุนูููุง |

---

## ูุฑุฌุน ุงูููุงุฑุณ

| ุงูุฌุฏูู | ุงูุฃุนูุฏุฉ ุงููููุฑุณุฉ |
|--------|-----------------|
| `users` | `email`ุ `role`ุ `is_active` |
| `projects` | `owner_id`ุ `status`ุ `city`ุ `average_rating` |
| `categories` | `parent_id`ุ `is_active`ุ `sort_order`ุ `status` |
| `products` | `project_id`ุ `category_id`ุ `status`ุ `is_available`ุ `average_rating`ุ `created_at` |
| `product_images` | `product_id` |
| `product_variants` | `product_id`ุ `is_available` |
| `product_tags` | `product_id`ุ `tag_id` |
| `cart_items` | `user_id`ุ `product_id` |
| `conversations` | `user1_id`ุ `user2_id`ุ `project_id`ุ `last_message_at` |
| `messages` | `conversation_id`ุ `sender_id`ุ `is_read`ุ `created_at` |
| `transactions` | `conversation_id`ุ `product_id`ุ `initiated_by`ุ `status`ุ `auto_confirm_at` |
| `reviews` | `product_id`ุ `user_id`ุ `status`ุ `rating` |
| `support_tickets` | `user_id`ุ `type`ุ `status`ุ `assigned_to`ุ `created_at` |
| `notifications` | `user_id`ุ `type`ุ `is_read`ุ `created_at` |
| `system_settings` | `setting_key` |
| `user_favorites` | `user_id`ุ `project_id` |

---

> **ุชู ุฅูุดุงุก ูุฐุง ุงููุณุชูุฏ ูู ุชุญููู ูููุงุช ุงูุชุฑุญูู**  
> **ุขุฎุฑ ุชุญุฏูุซ:** ููุงูุฑ 2026
